<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kafka Observability Mastery Lab - Learning App</title>
    <meta name="description" content="Master Kafka observability with New Relic through interactive hands-on exercises and real-world scenarios">
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>🚀</text></svg>">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="terminal.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo">
                <i class="fas fa-rocket"></i>
                <h2>Kafka Mastery Lab</h2>
                <p class="tagline">From Map-Reader to Map-Maker</p>
            </div>
            
            <div class="nav-section">
                <h3>Course Overview</h3>
                <ul class="nav-list">
                    <li><a href="#overview" class="nav-item active"><i class="fas fa-home"></i> Overview</a></li>
                    <li><a href="#quick-start" class="nav-item"><i class="fas fa-bolt"></i> Quick Start</a></li>
                    <li><a href="#prerequisites" class="nav-item"><i class="fas fa-check-circle"></i> Prerequisites</a></li>
                </ul>
            </div>

            <div class="nav-section">
                <h3>Learning Path</h3>
                <ul class="nav-list">
                    <li class="nav-week">
                        <a href="#week1" class="nav-item">
                            <i class="fas fa-x-ray"></i> Week 1: X-Ray Vision
                            <span class="progress-badge">0%</span>
                        </a>
                    </li>
                    <li class="nav-week">
                        <a href="#week2" class="nav-item">
                            <i class="fas fa-hammer"></i> Week 2: The Builder
                            <span class="progress-badge">0%</span>
                        </a>
                    </li>
                    <li class="nav-week">
                        <a href="#week3" class="nav-item">
                            <i class="fas fa-tachometer-alt"></i> Week 3: The Optimizer
                            <span class="progress-badge">0%</span>
                        </a>
                    </li>
                    <li class="nav-week">
                        <a href="#week4" class="nav-item">
                            <i class="fas fa-search"></i> Week 4: The Detective
                            <span class="progress-badge">0%</span>
                        </a>
                    </li>
                    <li class="nav-week">
                        <a href="#week5" class="nav-item">
                            <i class="fas fa-building"></i> Week 5: The Architect
                            <span class="progress-badge">0%</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="nav-section">
                <h3>New Features</h3>
                <ul class="nav-list">
                    <li><a href="#queues-streams" class="nav-item"><i class="fas fa-stream"></i> Queues & Streams <span class="badge-new">NEW</span></a></li>
                    <li><a href="#apm-360" class="nav-item"><i class="fas fa-globe"></i> APM 360 <span class="badge-new">NEW</span></a></li>
                </ul>
            </div>

            <div class="nav-section">
                <h3>Resources</h3>
                <ul class="nav-list">
                    <li><a href="#playground" class="nav-item"><i class="fas fa-code"></i> Code Playground</a></li>
                    <li><a href="#dashboards" class="nav-item"><i class="fas fa-chart-line"></i> Sample Dashboards</a></li>
                    <li><a href="#checklist" class="nav-item"><i class="fas fa-tasks"></i> Completion Checklist</a></li>
                </ul>
            </div>

            <div class="user-progress">
                <h3>Your Progress</h3>
                <div class="overall-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <p class="progress-text">0% Complete</p>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Overview Section -->
            <section id="overview" class="content-section active">
                <div class="section-header">
                    <h1>🚀 Kafka Observability Mastery Lab</h1>
                    <p class="subtitle">Transform from Map-Reader to Map-Maker in 5 Weeks</p>
                    <div class="update-badge">
                        <i class="fas fa-star"></i> Updated for 2025: New Relic Queues & Streams, APM 360
                    </div>
                    <div class="new-feature-banner">
                        <div class="feature-icon">
                            <i class="fas fa-rocket"></i>
                        </div>
                        <div class="feature-content">
                            <h3>🆕 New in 2025: Queues & Streams</h3>
                            <p>Experience bi-directional Kafka visibility with honeycomb visualization!</p>
                            <a href="#queues-streams" class="feature-link">Explore Now →</a>
                        </div>
                    </div>
                </div>

                <div class="features-grid">
                    <div class="feature-card" data-aos="fade-up" data-aos-delay="100">
                        <div class="feature-icon-wrapper">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3>Mental Model Translation</h3>
                        <p>Maps your API/microservices knowledge directly to Kafka concepts</p>
                        <div class="feature-highlight"></div>
                    </div>
                    <div class="feature-card" data-aos="fade-up" data-aos-delay="200">
                        <div class="feature-icon-wrapper">
                            <i class="fas fa-laptop-code"></i>
                        </div>
                        <h3>Hands-On First</h3>
                        <p>Every concept includes executable code and real scenarios</p>
                        <div class="feature-highlight"></div>
                    </div>
                    <div class="feature-card" data-aos="fade-up" data-aos-delay="300">
                        <div class="feature-icon-wrapper">
                            <i class="fas fa-industry"></i>
                        </div>
                        <h3>Production-Ready</h3>
                        <p>Learn patterns used by companies processing billions of messages daily</p>
                        <div class="feature-highlight"></div>
                    </div>
                    <div class="feature-card" data-aos="fade-up" data-aos-delay="400">
                        <div class="feature-icon-wrapper">
                            <i class="fas fa-sync"></i>
                        </div>
                        <h3>2025 Updated</h3>
                        <p>Covers New Relic's latest Queues & Streams and APM 360 features</p>
                        <div class="feature-highlight"></div>
                    </div>
                </div>

                <div class="learning-path-overview">
                    <h2>Your 5-Week Journey</h2>
                    <div class="journey-timeline">
                        <div class="timeline-item">
                            <div class="timeline-icon"><i class="fas fa-x-ray"></i></div>
                            <div class="timeline-content">
                                <h4>Week 1: X-Ray Vision</h4>
                                <p>Trace metrics from JMX to dashboards</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon"><i class="fas fa-hammer"></i></div>
                            <div class="timeline-content">
                                <h4>Week 2: The Builder</h4>
                                <p>Create custom OHI extensions</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon"><i class="fas fa-tachometer-alt"></i></div>
                            <div class="timeline-content">
                                <h4>Week 3: The Optimizer</h4>
                                <p>Performance tuning with metrics</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon"><i class="fas fa-search"></i></div>
                            <div class="timeline-content">
                                <h4>Week 4: The Detective</h4>
                                <p>Troubleshooting production issues</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon"><i class="fas fa-building"></i></div>
                            <div class="timeline-content">
                                <h4>Week 5: The Architect</h4>
                                <p>Design complete observability platforms</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Start Section -->
            <section id="quick-start" class="content-section">
                <div class="section-header">
                    <h1>⚡ Quick Start (5 minutes)</h1>
                    <p class="subtitle">Get your first Kafka observability win!</p>
                </div>

                <div class="quick-start-steps">
                    <div class="step-card">
                        <div class="step-number">1</div>
                        <h3>Prerequisites Check</h3>
                        <div class="code-block">
                            <pre><code class="language-bash"># Required tools
docker --version  # ≥ 24.0
git --version     # ≥ 2.0
curl --version    # any version</code></pre>
                        </div>
                        <button class="check-button" onclick="checkPrerequisites()">
                            <i class="fas fa-check"></i> Check Prerequisites
                        </button>
                    </div>

                    <div class="step-card">
                        <div class="step-number">2</div>
                        <h3>Clone & Launch</h3>
                        <div class="code-block">
                            <pre><code class="language-bash"># Clone the lab
git clone https://github.com/yourusername/qsLab.git
cd qsLab

# Launch your first lab
cd labs/week1-xray
docker-compose up -d</code></pre>
                        </div>
                        <button class="copy-button" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy Commands
                        </button>
                    </div>

                    <div class="step-card">
                        <div class="step-number">3</div>
                        <h3>Generate Test Data</h3>
                        <div class="code-block">
                            <pre><code class="language-bash"># Verify everything is running
docker-compose ps

# Generate test data
./scripts/generate-traffic.sh</code></pre>
                        </div>
                    </div>

                    <div class="step-card">
                        <div class="step-number">4</div>
                        <h3>Your First Metric!</h3>
                        <div class="code-block">
                            <pre><code class="language-bash"># See metrics in action
docker exec -it kafka-xray-jmxterm java -jar /jmxterm.jar -n <<EOF
open localhost:9999
get -b kafka.server:name=MessagesInPerSec,type=BrokerTopicMetrics Count
EOF</code></pre>
                        </div>
                        <div class="success-message" id="first-metric-success" style="display: none;">
                            <div class="success-icon-wrapper">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="success-content">
                                <p class="success-title">Success!</p>
                                <p>If you see <code>Count = 5002</code>, congratulations! You've just queried a raw Kafka JMX metric!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Week 1 Content -->
            <section id="week1" class="content-section">
                <div class="section-header">
                    <h1>📚 Week 1: X-Ray Vision - Metric Tracing</h1>
                    <p class="subtitle">Master the flow from JMX to New Relic dashboards</p>
                </div>

                <div class="learning-objectives">
                    <h2>Learning Objectives</h2>
                    <ul class="objective-list">
                        <li class="objective-item">
                            <input type="checkbox" id="obj-1-1">
                            <label for="obj-1-1">Understand how Kafka exposes metrics via JMX</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-1-2">
                            <label for="obj-1-2">Trace metric flow: JMX → nri-kafka → New Relic</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-1-3">
                            <label for="obj-1-3">Master counter-to-rate transformations</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-1-4">
                            <label for="obj-1-4">Configure metric collection and filtering</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-1-5">
                            <label for="obj-1-5">Set up New Relic Queues & Streams for Kafka</label>
                        </li>
                    </ul>
                </div>

                <div class="exercise-container">
                    <h2>🔬 Exercise 1: Trace broker.messagesInPerSec End-to-End</h2>
                    
                    <div class="exercise-tabs">
                        <button class="tab-button active" onclick="showTab('week1-part1')">Part 1: Setup</button>
                        <button class="tab-button" onclick="showTab('week1-part2')">Part 2: JMX</button>
                        <button class="tab-button" onclick="showTab('week1-part3')">Part 3: Rate Calc</button>
                        <button class="tab-button" onclick="showTab('week1-part4')">Part 4: nri-kafka</button>
                        <button class="tab-button" onclick="showTab('week1-part5')">Part 5: New Relic</button>
                    </div>

                    <div id="week1-part1" class="tab-content active">
                        <h3>Part 1: Setup & Generate Traffic</h3>
                        <div class="interactive-exercise">
                            <div class="code-block">
                                <pre><code class="language-bash"># 1. Start the environment
cd labs/week1-xray
docker-compose up -d

# 2. Create test topic
docker exec -it kafka-xray-broker \
  kafka-topics --create --topic test-events \
  --bootstrap-server localhost:9092 \
  --partitions 3 --replication-factor 1

# 3. Generate sustained traffic
docker exec -d kafka-xray-broker \
  kafka-producer-perf-test \
  --topic test-events \
  --num-records 100000 \
  --record-size 100 \
  --throughput 1000 \
  --producer-props bootstrap.servers=localhost:9092</code></pre>
                            </div>
                            <button class="run-button" onclick="executeInEmbeddedTerminal('week1-terminal', 'docker-compose up -d')">
                                <i class="fas fa-play"></i> Run Environment Setup
                            </button>
                            
                            <!-- Embedded Terminal -->
                            <div class="inline-terminal">
                                <button class="terminal-toggle" onclick="toggleTerminal('week1-terminal')">
                                    <span><i class="fas fa-terminal"></i> Interactive Terminal</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="collapsible-terminal" id="week1-terminal-container">
                                    <div id="week1-terminal"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="week1-part2" class="tab-content">
                        <h3>Part 2: Explore JMX MBeans</h3>
                        <div class="key-insight">
                            <div class="insight-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="insight-content">
                                <p class="insight-title">Key Insight</p>
                                <p>The <code>Count</code> attribute is a monotonic counter. To get rate: <code>Rate = (Count_T2 - Count_T1) / (T2 - T1)</code></p>
                            </div>
                        </div>
                        <div class="interactive-jmx">
                            <h4>JMX Terminal Simulator</h4>
                            <div class="terminal-container">
                                <div class="terminal-header">JMXTerm Session</div>
                                <div class="terminal-body">
                                    <input type="text" class="terminal-input" placeholder="Enter JMX command..." onkeypress="handleJMXCommand(event)">
                                    <div class="terminal-output" id="jmx-output">
                                        <p>Welcome to JMXTerm simulator. Type 'help' for commands.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="week1-part3" class="tab-content">
                        <h3>Part 3: Manual Rate Calculation</h3>
                        <div class="rate-calculator">
                            <h4>Interactive Rate Calculator</h4>
                            <div class="calc-inputs">
                                <div class="input-group">
                                    <label>Count at T1:</label>
                                    <input type="number" id="count1" value="5000">
                                </div>
                                <div class="input-group">
                                    <label>Count at T2:</label>
                                    <input type="number" id="count2" value="15000">
                                </div>
                                <div class="input-group">
                                    <label>Time Interval (seconds):</label>
                                    <input type="number" id="timeInterval" value="10">
                                </div>
                            </div>
                            <button class="calculate-button" onclick="calculateRate()">
                                <i class="fas fa-calculator"></i> Calculate Rate
                            </button>
                            <div class="calc-result" id="rate-result"></div>
                        </div>
                    </div>
                </div>

                <!-- Metric Journey Visualization -->
                <div class="metric-journey">
                    <h2>📊 The Complete Metric Journey</h2>
                    <div class="journey-diagram">
                        <div class="journey-step">
                            <div class="step-icon"><i class="fas fa-database"></i></div>
                            <div class="step-label">Kafka Internal Counter</div>
                        </div>
                        <div class="journey-arrow">→</div>
                        <div class="journey-step">
                            <div class="step-icon"><i class="fas fa-cog"></i></div>
                            <div class="step-label">JMX MBean</div>
                        </div>
                        <div class="journey-arrow">→</div>
                        <div class="journey-step">
                            <div class="step-icon"><i class="fas fa-search"></i></div>
                            <div class="step-label">nri-kafka Discovery</div>
                        </div>
                        <div class="journey-arrow">→</div>
                        <div class="journey-step">
                            <div class="step-icon"><i class="fas fa-chart-line"></i></div>
                            <div class="step-label">Rate Calculation</div>
                        </div>
                        <div class="journey-arrow">→</div>
                        <div class="journey-step">
                            <div class="step-icon"><i class="fas fa-server"></i></div>
                            <div class="step-label">Infrastructure Agent</div>
                        </div>
                        <div class="journey-arrow">→</div>
                        <div class="journey-step">
                            <div class="step-icon"><i class="fas fa-cloud"></i></div>
                            <div class="step-label">New Relic Platform</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Week 2 Content -->
            <section id="week2" class="content-section">
                <div class="section-header">
                    <h1>🔨 Week 2: The Builder - Custom Integrations</h1>
                    <p class="subtitle">Create custom observability solutions for missing metrics</p>
                </div>

                <div class="learning-objectives">
                    <h2>Learning Objectives</h2>
                    <ul class="objective-list">
                        <li class="objective-item">
                            <input type="checkbox" id="obj-2-1">
                            <label for="obj-2-1">Identify missing metrics in standard integrations</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-2-2">
                            <label for="obj-2-2">Build custom OHI integrations</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-2-3">
                            <label for="obj-2-3">Deploy and monitor tombstone metrics</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-2-4">
                            <label for="obj-2-4">Compare integration approaches (OHI vs Flex vs APM)</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-2-5">
                            <label for="obj-2-5">Integrate with Java agents for deeper insights</label>
                        </li>
                    </ul>
                </div>

                <div class="exercise-container">
                    <h2>🛠️ Exercise: Build Custom Tombstone Monitor</h2>
                    
                    <div class="exercise-tabs">
                        <button class="tab-button active" onclick="showTab('week2-part1')">Part 1: Discovery</button>
                        <button class="tab-button" onclick="showTab('week2-part2')">Part 2: Build OHI</button>
                        <button class="tab-button" onclick="showTab('week2-part3')">Part 3: Deploy</button>
                        <button class="tab-button" onclick="showTab('week2-part4')">Part 4: Visualize</button>
                    </div>

                    <div id="week2-part1" class="tab-content active">
                        <h3>Part 1: Discover Missing Metrics</h3>
                        <div class="interactive-exercise">
                            <div class="code-block">
                                <pre><code class="language-bash"># Check what metrics nri-kafka provides
docker exec -it kafka-xray-newrelic /var/db/newrelic-infra/nri-kafka -pretty

# Look for tombstone metrics (they're missing!)
# Let's check Kafka's admin tools
docker exec -it kafka-xray-broker kafka-log-dirs \
  --bootstrap-server localhost:9092 \
  --describe --topic-list test-events</code></pre>
                            </div>
                            <button class="run-button" onclick="executeInEmbeddedTerminal('week2-terminal', 'docker exec -it kafka-xray-newrelic /var/db/newrelic-infra/nri-kafka -pretty')">
                                <i class="fas fa-search"></i> Discover Metrics
                            </button>
                            
                            <!-- Embedded Terminal -->
                            <div class="inline-terminal">
                                <button class="terminal-toggle" onclick="toggleTerminal('week2-terminal')">
                                    <span><i class="fas fa-terminal"></i> Interactive Terminal</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="collapsible-terminal" id="week2-terminal-container">
                                    <div id="week2-terminal"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="week2-part2" class="tab-content">
                        <h3>Part 2: Build Custom OHI Integration</h3>
                        <div class="key-insight">
                            <div class="insight-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="insight-content">
                                <p class="insight-title">Design Decision</p>
                                <p>OHI integrations are perfect for complex metrics that need processing, while Flex is great for simple script outputs.</p>
                            </div>
                        </div>
                        <div class="code-block">
                            <pre><code class="language-go">// custom-integrations/tombstone-monitor/main.go
package main

import (
    "encoding/json"
    "fmt"
    "os/exec"
    "regexp"
    "strconv"
)

type TombstoneMetric struct {
    EventType    string `json:"event_type"`
    Topic        string `json:"topic"`
    Partition    int    `json:"partition"`
    TombstoneCount int64 `json:"tombstone_count"`
    PercentageOfLog float64 `json:"tombstone_percentage"`
}

func main() {
    // Execute kafka-log-dirs command
    cmd := exec.Command("kafka-log-dirs", 
        "--bootstrap-server", "localhost:9092",
        "--describe")
    
    output, err := cmd.Output()
    if err != nil {
        fmt.Printf("Error: %v\n", err)
        return
    }
    
    // Parse output for tombstone metrics
    metrics := parseTombstoneMetrics(string(output))
    
    // Output in New Relic format
    outputMetrics(metrics)
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Week 3 Content -->
            <section id="week3" class="content-section">
                <div class="section-header">
                    <h1>⚡ Week 3: The Optimizer - Performance Tuning</h1>
                    <p class="subtitle">Use metrics to optimize Kafka performance</p>
                </div>

                <div class="learning-objectives">
                    <h2>Learning Objectives</h2>
                    <ul class="objective-list">
                        <li class="objective-item">
                            <input type="checkbox" id="obj-3-1">
                            <label for="obj-3-1">Run performance baselines with different configurations</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-3-2">
                            <label for="obj-3-2">Identify bottlenecks using metrics</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-3-3">
                            <label for="obj-3-3">Optimize producer and consumer configurations</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-3-4">
                            <label for="obj-3-4">Create performance dashboards and alerts</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-3-5">
                            <label for="obj-3-5">Document scaling patterns and best practices</label>
                        </li>
                    </ul>
                </div>

                <div class="exercise-container">
                    <h2>🚀 Exercise: Performance Optimization Lab</h2>
                    
                    <div class="exercise-tabs">
                        <button class="tab-button active" onclick="showTab('week3-part1')">Baseline</button>
                        <button class="tab-button" onclick="showTab('week3-part2')">Bottlenecks</button>
                        <button class="tab-button" onclick="showTab('week3-part3')">Optimize</button>
                        <button class="tab-button" onclick="showTab('week3-part4')">Measure</button>
                    </div>

                    <div id="week3-part1" class="tab-content active">
                        <h3>Establish Performance Baseline</h3>
                        <div class="interactive-exercise">
                            <div class="code-block">
                                <pre><code class="language-bash"># Run performance test with default settings
docker exec -it kafka-xray-broker kafka-producer-perf-test \
  --topic perf-test \
  --num-records 1000000 \
  --record-size 1024 \
  --throughput -1 \
  --producer-props bootstrap.servers=localhost:9092

# Monitor key metrics during test
watch -n 1 'docker exec kafka-xray-broker kafka-run-class kafka.tools.JmxTool \
  --object-name kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec \
  --attributes OneMinuteRate'</code></pre>
                            </div>
                            <button class="run-button" onclick="executeInEmbeddedTerminal('week3-terminal', 'docker exec -it kafka-xray-broker kafka-topics --create --topic perf-test --bootstrap-server localhost:9092 --partitions 6')">
                                <i class="fas fa-tachometer-alt"></i> Run Baseline Test
                            </button>
                            
                            <!-- Embedded Terminal -->
                            <div class="inline-terminal">
                                <button class="terminal-toggle" onclick="toggleTerminal('week3-terminal')">
                                    <span><i class="fas fa-terminal"></i> Interactive Terminal</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="collapsible-terminal" id="week3-terminal-container">
                                    <div id="week3-terminal"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Week 4 Content -->
            <section id="week4" class="content-section">
                <div class="section-header">
                    <h1>🔍 Week 4: The Detective - Troubleshooting</h1>
                    <p class="subtitle">Master production issue resolution with observability</p>
                </div>

                <div class="learning-objectives">
                    <h2>Learning Objectives</h2>
                    <ul class="objective-list">
                        <li class="objective-item">
                            <input type="checkbox" id="obj-4-1">
                            <label for="obj-4-1">Debug consumer lag issues systematically</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-4-2">
                            <label for="obj-4-2">Implement distributed tracing for Kafka</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-4-3">
                            <label for="obj-4-3">Create automated runbooks for common issues</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-4-4">
                            <label for="obj-4-4">Build correlation queries across metrics, logs, and traces</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-4-5">
                            <label for="obj-4-5">Master troubleshooting methodology</label>
                        </li>
                    </ul>
                </div>

                <div class="exercise-container">
                    <h2>🕵️ Exercise: Debug Consumer Lag Crisis</h2>
                    
                    <div class="exercise-tabs">
                        <button class="tab-button active" onclick="showTab('week4-part1')">Simulate Issue</button>
                        <button class="tab-button" onclick="showTab('week4-part2')">Investigate</button>
                        <button class="tab-button" onclick="showTab('week4-part3')">Root Cause</button>
                        <button class="tab-button" onclick="showTab('week4-part4')">Resolution</button>
                    </div>

                    <div id="week4-part1" class="tab-content active">
                        <h3>Simulate Consumer Lag Scenario</h3>
                        <div class="interactive-exercise">
                            <div class="code-block">
                                <pre><code class="language-bash"># Create high-volume topic
docker exec -it kafka-xray-broker kafka-topics --create \
  --topic high-volume \
  --bootstrap-server localhost:9092 \
  --partitions 12 \
  --replication-factor 1

# Start slow consumer
docker exec -d kafka-xray-broker kafka-console-consumer \
  --bootstrap-server localhost:9092 \
  --topic high-volume \
  --group slow-consumer \
  --from-beginning \
  --max-messages 10

# Generate heavy load
docker exec -d kafka-xray-broker kafka-producer-perf-test \
  --topic high-volume \
  --num-records 5000000 \
  --record-size 1024 \
  --throughput 50000 \
  --producer-props bootstrap.servers=localhost:9092</code></pre>
                            </div>
                            <button class="run-button" onclick="executeInEmbeddedTerminal('week4-terminal', 'docker exec -it kafka-xray-broker kafka-topics --create --topic high-volume --bootstrap-server localhost:9092 --partitions 12')">
                                <i class="fas fa-exclamation-triangle"></i> Create Lag Scenario
                            </button>
                            
                            <!-- Embedded Terminal -->
                            <div class="inline-terminal">
                                <button class="terminal-toggle" onclick="toggleTerminal('week4-terminal')">
                                    <span><i class="fas fa-terminal"></i> Interactive Terminal</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="collapsible-terminal" id="week4-terminal-container">
                                    <div id="week4-terminal"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Week 5 Content -->
            <section id="week5" class="content-section">
                <div class="section-header">
                    <h1>🏗️ Week 5: The Architect - Platform Design</h1>
                    <p class="subtitle">Design and build production-grade observability platforms</p>
                </div>

                <div class="learning-objectives">
                    <h2>Learning Objectives</h2>
                    <ul class="objective-list">
                        <li class="objective-item">
                            <input type="checkbox" id="obj-5-1">
                            <label for="obj-5-1">Design multi-region Kafka monitoring architecture</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-5-2">
                            <label for="obj-5-2">Implement security hardening for monitoring</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-5-3">
                            <label for="obj-5-3">Build comprehensive dashboards for different personas</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-5-4">
                            <label for="obj-5-4">Create automation framework for operations</label>
                        </li>
                        <li class="objective-item">
                            <input type="checkbox" id="obj-5-5">
                            <label for="obj-5-5">Define SLOs and error budgets</label>
                        </li>
                    </ul>
                </div>

                <div class="exercise-container">
                    <h2>🏛️ Exercise: Build Multi-Region Platform</h2>
                    
                    <div class="exercise-tabs">
                        <button class="tab-button active" onclick="showTab('week5-part1')">Architecture</button>
                        <button class="tab-button" onclick="showTab('week5-part2')">Security</button>
                        <button class="tab-button" onclick="showTab('week5-part3')">Dashboards</button>
                        <button class="tab-button" onclick="showTab('week5-part4')">Automation</button>
                    </div>

                    <div id="week5-part1" class="tab-content active">
                        <h3>Design Multi-Region Architecture</h3>
                        <div class="interactive-exercise">
                            <div class="code-block">
                                <pre><code class="language-yaml"># multi-region-monitoring.yml
global:
  regions:
    - us-east-1
    - eu-west-1
    - ap-south-1
  
monitoring:
  infrastructure:
    - type: new-relic-infrastructure
      config:
        custom_attributes:
          region: ${REGION}
          environment: ${ENV}
          cluster: ${CLUSTER_NAME}
  
  integrations:
    - name: nri-kafka
      interval: 30s
      config:
        cluster_name: ${CLUSTER_NAME}-${REGION}
        autodiscover_strategy: bootstrap
        bootstrap_broker_host: ${KAFKA_BOOTSTRAP}
        
  aggregation:
    - type: cross-region-dashboard
      metrics:
        - broker.messagesInPerSec
        - consumer.lag
        - broker.activeControllerCount</code></pre>
                            </div>
                            <button class="run-button" onclick="executeInEmbeddedTerminal('week5-terminal', 'echo \"Deploying multi-region monitoring...\"')">
                                <i class="fas fa-globe"></i> Deploy Architecture
                            </button>
                            
                            <!-- Embedded Terminal -->
                            <div class="inline-terminal">
                                <button class="terminal-toggle" onclick="toggleTerminal('week5-terminal')">
                                    <span><i class="fas fa-terminal"></i> Interactive Terminal</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="collapsible-terminal" id="week5-terminal-container">
                                    <div id="week5-terminal"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Queues & Streams Section -->
            <section id="queues-streams" class="content-section">
                <div class="section-header">
                    <h1>🆕 New Relic Queues & Streams</h1>
                    <p class="subtitle">Bi-directional visibility for Kafka with honeycomb visualization</p>
                    <span class="badge-new">2025 Feature</span>
                </div>

                <div class="feature-overview">
                    <div class="feature-description">
                        <h2>What is Queues & Streams?</h2>
                        <p>New Relic's Queues & Streams provides unprecedented visibility into your message queue infrastructure, specifically designed for Apache Kafka, Amazon Kinesis, and other streaming platforms.</p>
                        
                        <div class="feature-benefits">
                            <div class="benefit-card">
                                <i class="fas fa-project-diagram"></i>
                                <h3>Honeycomb Visualization</h3>
                                <p>See your entire Kafka cluster health at a glance with interactive honeycomb diagrams</p>
                            </div>
                            <div class="benefit-card">
                                <i class="fas fa-exchange-alt"></i>
                                <h3>Bi-Directional Mapping</h3>
                                <p>Connect topics to both producers AND consumers with full trace context</p>
                            </div>
                            <div class="benefit-card">
                                <i class="fas fa-link"></i>
                                <h3>APM Integration</h3>
                                <p>Seamlessly navigate from application traces to infrastructure metrics</p>
                            </div>
                        </div>
                    </div>

                    <div class="interactive-demo">
                        <h2>Try It Now</h2>
                        <div class="demo-container">
                            <div class="honeycomb-simulator" id="honeycomb-demo">
                                <!-- Interactive honeycomb visualization will be rendered here -->
                            </div>
                            <div class="demo-controls">
                                <button onclick="simulateHealthy()"><i class="fas fa-check-circle"></i> Healthy Cluster</button>
                                <button onclick="simulateLag()"><i class="fas fa-exclamation-triangle"></i> Consumer Lag</button>
                                <button onclick="simulateError()"><i class="fas fa-times-circle"></i> Producer Errors</button>
                            </div>
                        </div>
                    </div>

                    <div class="setup-guide">
                        <h2>Quick Setup Guide</h2>
                        <div class="setup-steps">
                            <div class="setup-step">
                                <div class="step-number">1</div>
                                <h3>Enable Java Agent</h3>
                                <pre><code class="language-bash"># Add to your producer/consumer startup
-javaagent:/path/to/newrelic.jar
-Dnewrelic.config.distributed_tracing.enabled=true</code></pre>
                            </div>
                            <div class="setup-step">
                                <div class="step-number">2</div>
                                <h3>Configure Kafka Integration</h3>
                                <pre><code class="language-yaml"># In your newrelic.yml
class_transformer:
  com.newrelic.instrumentation.kafka-clients-spans-2.0.0:
    enabled: true</code></pre>
                            </div>
                            <div class="setup-step">
                                <div class="step-number">3</div>
                                <h3>Access Queues & Streams</h3>
                                <p>Navigate to: <strong>one.newrelic.com</strong> > <strong>All capabilities</strong> > <strong>Queues & Streams</strong></p>
                            </div>
                        </div>
                    </div>

                    <div class="nrql-examples">
                        <h2>Powerful NRQL Queries</h2>
                        <div class="query-cards">
                            <div class="query-card">
                                <h3>Message Flow Analysis</h3>
                                <pre><code class="language-sql">FROM MessageTrace 
SELECT count(*) 
FACET topic, producer.service.name, consumer.service.name 
SINCE 30 minutes ago</code></pre>
                                <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy</button>
                            </div>
                            <div class="query-card">
                                <h3>Consumer Lag Monitoring</h3>
                                <pre><code class="language-sql">FROM MessageTrace 
SELECT max(consumer.lag) 
FACET consumer.service.name, topic 
WHERE consumer.lag > 100</code></pre>
                                <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy</button>
                            </div>
                            <div class="query-card">
                                <h3>Error Rate by Topic</h3>
                                <pre><code class="language-sql">FROM MessageTrace 
SELECT percentage(count(*), WHERE error = true) as 'Error Rate' 
FACET topic 
TIMESERIES</code></pre>
                                <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- APM 360 Section -->
            <section id="apm-360" class="content-section">
                <div class="section-header">
                    <h1>🌐 APM 360 - Unified Kafka View</h1>
                    <p class="subtitle">Complete application and infrastructure observability in one place</p>
                    <span class="badge-new">2025 Feature</span>
                </div>

                <div class="apm360-overview">
                    <h2>Unified Observability Platform</h2>
                    <p>APM 360 brings together application performance monitoring and infrastructure metrics, providing a complete view of your Kafka ecosystem.</p>
                    
                    <div class="integration-flow">
                        <div class="flow-step">
                            <i class="fas fa-code"></i>
                            <h3>Application Layer</h3>
                            <p>Service performance & traces</p>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">
                            <i class="fas fa-stream"></i>
                            <h3>Kafka Layer</h3>
                            <p>Topics, partitions & lag</p>
                        </div>
                        <div class="flow-arrow">→</div>
                        <div class="flow-step">
                            <i class="fas fa-server"></i>
                            <h3>Infrastructure Layer</h3>
                            <p>Brokers, nodes & resources</p>
                        </div>
                    </div>

                    <div class="key-features">
                        <h2>Key Features</h2>
                        <ul class="feature-list">
                            <li><i class="fas fa-check"></i> Single pane of glass for all Kafka metrics</li>
                            <li><i class="fas fa-check"></i> Automatic service dependency mapping</li>
                            <li><i class="fas fa-check"></i> Intelligent anomaly detection</li>
                            <li><i class="fas fa-check"></i> Cost analysis and optimization recommendations</li>
                            <li><i class="fas fa-check"></i> Pre-built dashboards and alerts</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Code Playground Section -->
            <section id="playground" class="content-section">
                <div class="section-header">
                    <h1>🎮 Code Playground</h1>
                    <p class="subtitle">Practice and experiment with code examples</p>
                </div>
                

                <div class="playground-container">
                    <div class="playground-tabs">
                        <button class="tab-button active" onclick="showPlaygroundTab('terminal')">Terminal</button>
                        <button class="tab-button" onclick="showPlaygroundTab('bash')">Templates</button>
                        <button class="tab-button" onclick="showPlaygroundTab('yaml')">YAML</button>
                        <button class="tab-button" onclick="showPlaygroundTab('nrql')">NRQL</button>
                    </div>
                    
                    <div id="playground-terminal" class="playground-tab active">
                        <h3>Interactive Terminal</h3>
                        <p>Run any Docker or Kafka command. Try <code>help</code> for available commands.</p>
                        <div id="playground-main-terminal" style="margin-top: 1rem;"></div>
                    </div>

                    <div id="playground-bash" class="playground-tab">
                        <h3>Command Templates</h3>
                        <div class="command-templates">
                            <div class="template-category">
                                <h4>Kafka Operations</h4>
                                <button class="template-btn" onclick="copyToTerminal('docker exec -it kafka-broker kafka-topics --list --bootstrap-server localhost:9092')">
                                    <i class="fas fa-list"></i> List Topics
                                </button>
                                <button class="template-btn" onclick="copyToTerminal('docker exec -it kafka-broker kafka-topics --create --topic test-topic --bootstrap-server localhost:9092 --partitions 3')">
                                    <i class="fas fa-plus"></i> Create Topic
                                </button>
                                <button class="template-btn" onclick="copyToTerminal('docker exec -it kafka-broker kafka-console-producer --topic test-topic --bootstrap-server localhost:9092')">
                                    <i class="fas fa-paper-plane"></i> Start Producer
                                </button>
                                <button class="template-btn" onclick="copyToTerminal('docker exec -it kafka-broker kafka-console-consumer --topic test-topic --from-beginning --bootstrap-server localhost:9092')">
                                    <i class="fas fa-inbox"></i> Start Consumer
                                </button>
                            </div>
                            <div class="template-category">
                                <h4>Docker Commands</h4>
                                <button class="template-btn" onclick="copyToTerminal('docker ps')">
                                    <i class="fas fa-server"></i> List Containers
                                </button>
                                <button class="template-btn" onclick="copyToTerminal('docker logs --tail 50 kafka-broker')">
                                    <i class="fas fa-file-alt"></i> View Logs
                                </button>
                                <button class="template-btn" onclick="copyToTerminal('docker stats --no-stream')">
                                    <i class="fas fa-chart-bar"></i> Resource Stats
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="playground-yaml" class="playground-tab">
                        <h3>Configuration YAML</h3>
                        <textarea class="code-editor" rows="10" placeholder="# Enter your YAML configuration here...
integrations:
  - name: nri-kafka
    env:
      CLUSTER_NAME: 'my-cluster'"></textarea>
                        <button class="validate-button" onclick="validateYAML()">
                            <i class="fas fa-check"></i> Validate YAML
                        </button>
                    </div>

                    <div id="playground-nrql" class="playground-tab">
                        <h3>NRQL Queries</h3>
                        <textarea class="code-editor" rows="10" placeholder="-- Enter your NRQL queries here...
FROM KafkaBrokerSample 
SELECT average(broker.messagesInPerSec) 
TIMESERIES SINCE 30 minutes ago"></textarea>
                        <button class="run-playground" onclick="runPlaygroundCode('nrql')">
                            <i class="fas fa-database"></i> Run Query
                        </button>
                    </div>

                    <div class="playground-output">
                        <h4>Output:</h4>
                        <pre id="playground-result"></pre>
                    </div>
                </div>
            </section>

            <!-- Progress Checklist -->
            <section id="checklist" class="content-section">
                <div class="section-header">
                    <h1>🎯 Course Completion Checklist</h1>
                    <p class="subtitle">Track your progress through the entire journey</p>
                </div>

                <div class="checklist-grid">
                    <div class="checklist-week">
                        <h3><i class="fas fa-x-ray"></i> Week 1: X-Ray Vision</h3>
                        <ul class="checklist">
                            <li><input type="checkbox" id="w1-1"><label for="w1-1">Traced a metric from JMX to dashboard</label></li>
                            <li><input type="checkbox" id="w1-2"><label for="w1-2">Understood counter-to-rate transformation</label></li>
                            <li><input type="checkbox" id="w1-3"><label for="w1-3">Configured nri-kafka successfully</label></li>
                            <li><input type="checkbox" id="w1-4"><label for="w1-4">Created first NRQL queries</label></li>
                            <li><input type="checkbox" id="w1-5"><label for="w1-5">Set up Queues & Streams</label></li>
                        </ul>
                    </div>

                    <div class="checklist-week">
                        <h3><i class="fas fa-hammer"></i> Week 2: The Builder</h3>
                        <ul class="checklist">
                            <li><input type="checkbox" id="w2-1"><label for="w2-1">Identified missing metrics</label></li>
                            <li><input type="checkbox" id="w2-2"><label for="w2-2">Built custom OHI integration</label></li>
                            <li><input type="checkbox" id="w2-3"><label for="w2-3">Deployed tombstone monitor</label></li>
                            <li><input type="checkbox" id="w2-4"><label for="w2-4">Compared integration approaches</label></li>
                            <li><input type="checkbox" id="w2-5"><label for="w2-5">Integrated Java agents</label></li>
                        </ul>
                    </div>

                    <div class="checklist-week">
                        <h3><i class="fas fa-tachometer-alt"></i> Week 3: The Optimizer</h3>
                        <ul class="checklist">
                            <li><input type="checkbox" id="w3-1"><label for="w3-1">Ran performance baselines</label></li>
                            <li><input type="checkbox" id="w3-2"><label for="w3-2">Identified bottlenecks</label></li>
                            <li><input type="checkbox" id="w3-3"><label for="w3-3">Optimized configurations</label></li>
                            <li><input type="checkbox" id="w3-4"><label for="w3-4">Created performance dashboards</label></li>
                            <li><input type="checkbox" id="w3-5"><label for="w3-5">Documented scaling patterns</label></li>
                        </ul>
                    </div>

                    <div class="checklist-week">
                        <h3><i class="fas fa-search"></i> Week 4: The Detective</h3>
                        <ul class="checklist">
                            <li><input type="checkbox" id="w4-1"><label for="w4-1">Debugged consumer lag issue</label></li>
                            <li><input type="checkbox" id="w4-2"><label for="w4-2">Implemented distributed tracing</label></li>
                            <li><input type="checkbox" id="w4-3"><label for="w4-3">Created runbook automation</label></li>
                            <li><input type="checkbox" id="w4-4"><label for="w4-4">Built correlation queries</label></li>
                            <li><input type="checkbox" id="w4-5"><label for="w4-5">Mastered troubleshooting</label></li>
                        </ul>
                    </div>

                    <div class="checklist-week">
                        <h3><i class="fas fa-building"></i> Week 5: The Architect</h3>
                        <ul class="checklist">
                            <li><input type="checkbox" id="w5-1"><label for="w5-1">Designed multi-region monitoring</label></li>
                            <li><input type="checkbox" id="w5-2"><label for="w5-2">Implemented security hardening</label></li>
                            <li><input type="checkbox" id="w5-3"><label for="w5-3">Built comprehensive dashboards</label></li>
                            <li><input type="checkbox" id="w5-4"><label for="w5-4">Created automation framework</label></li>
                            <li><input type="checkbox" id="w5-5"><label for="w5-5">Defined SLOs and error budgets</label></li>
                        </ul>
                    </div>
                </div>

                <div class="completion-certificate" id="certificate" style="display: none;">
                    <div class="certificate-stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <h2>🎉 Congratulations!</h2>
                    <p class="certificate-subtitle">You've completed the Kafka Observability Mastery Lab!</p>
                    <p class="certificate-achievement">You are now a certified Kafka Observability Expert</p>
                    <button class="download-cert" onclick="downloadCertificate()">
                        <i class="fas fa-download"></i> Download Certificate
                    </button>
                    <button class="share-achievement" onclick="shareAchievement()">
                        <i class="fas fa-share-alt"></i> Share Achievement
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="terminal.js"></script>
    <script src="app.js"></script>
</body>
</html>